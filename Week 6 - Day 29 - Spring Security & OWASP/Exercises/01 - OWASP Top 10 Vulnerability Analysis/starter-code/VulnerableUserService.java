package com.security;

/**
 * Intentionally vulnerable service — DO NOT use in production!
 * Study each method and identify the security flaw before moving to SecureUserService.
 */
public class VulnerableUserService {

    /**
     * VULNERABILITY: SQL query built by string concatenation.
     * An attacker can pass id = "1 OR 1=1" to dump all users.
     */
    public String getUserById(String id) {
        // Simulated query — in real code this would execute against a database
        String query = "SELECT * FROM users WHERE id = " + id;
        System.out.println("Executing: " + query);
        return "User{id=" + id + "}";
    }

    /**
     * VULNERABILITY: Plaintext password stored and compared directly.
     * If the database is breached, all passwords are immediately exposed.
     */
    public boolean login(String username, String storedPlainTextPassword, String inputPassword) {
        // Direct string comparison — no hashing whatsoever
        return storedPlainTextPassword.equals(inputPassword);
    }

    /**
     * VULNERABILITY: Sensitive configuration values (API keys, DB passwords) returned
     * directly to any caller — exposing them in logs, responses, or error messages.
     */
    public String getConfigValue(String key) {
        // Simulates reading from a config store
        if ("db.password".equals(key)) {
            return "SuperSecret123!";     // secret returned in plain text
        }
        return "unknown";
    }

    /**
     * VULNERABILITY: User-controlled input written directly to the log.
     * Attacker can inject newlines to forge additional log entries.
     */
    public void logUserAction(String userInput) {
        // e.g. userInput = "login\nINFO: Admin logged in" fakes a second log line
        System.out.println("INFO: User performed action: " + userInput);
    }
}
