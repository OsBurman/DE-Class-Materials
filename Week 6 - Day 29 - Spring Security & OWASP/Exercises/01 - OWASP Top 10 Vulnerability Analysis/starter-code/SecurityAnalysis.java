package com.security;

import java.util.LinkedHashMap;
import java.util.Map;

/**
 * Exercise 01 – OWASP Vulnerability Analysis
 *
 * TODO: Fill in the correct OWASP Top 10 category name for each method below.
 *       Use the OWASP constants defined at the top of this class.
 */
public class SecurityAnalysis {

    // ── OWASP Top 10 (2021) category constants ─────────────────────────────
    public static final String A01 = "A01:2021 - Broken Access Control";
    public static final String A02 = "A02:2021 - Cryptographic Failures";
    public static final String A03 = "A03:2021 - Injection";
    public static final String A04 = "A04:2021 - Insecure Design";
    public static final String A05 = "A05:2021 - Security Misconfiguration";
    public static final String A06 = "A06:2021 - Vulnerable and Outdated Components";
    public static final String A07 = "A07:2021 - Identification and Authentication Failures";
    public static final String A08 = "A08:2021 - Software and Data Integrity Failures";
    public static final String A09 = "A09:2021 - Security Logging and Monitoring Failures";
    public static final String A10 = "A10:2021 - Server-Side Request Forgery";

    /**
     * Returns a map of method name → OWASP category for each vulnerable method
     * in VulnerableUserService.
     *
     * TODO: Replace each null with the correct OWASP constant from above.
     */
    public Map<String, String> analyzeVulnerabilities() {
        Map<String, String> analysis = new LinkedHashMap<>();

        // TODO: getUserById uses string concatenation to build a SQL query
        analysis.put("getUserById", null);

        // TODO: login compares plaintext passwords without any hashing
        analysis.put("login", null);

        // TODO: getConfigValue returns secret credentials directly to the caller
        analysis.put("getConfigValue", null);

        // TODO: logUserAction writes user-controlled input straight into the log
        analysis.put("logUserAction", null);

        return analysis;
    }

    public static void main(String[] args) {
        SecurityAnalysis sa = new SecurityAnalysis();
        System.out.println("=== OWASP Vulnerability Analysis ===");
        sa.analyzeVulnerabilities().forEach((method, category) ->
            System.out.printf("%-20s → %s%n", method, category));
    }
}
