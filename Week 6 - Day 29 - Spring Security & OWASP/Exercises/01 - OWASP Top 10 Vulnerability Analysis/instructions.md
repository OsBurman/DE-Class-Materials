# Exercise 01: OWASP Top 10 Vulnerability Analysis

## Objective

Identify common security vulnerabilities in existing Java code, map each flaw to its OWASP Top 10 category, and rewrite each method to follow secure coding principles.

## Background

The OWASP Top 10 is the industry-standard list of the most critical web application security risks. Every professional developer must be able to spot these flaws in code review. In this exercise you are given a `VulnerableUserService` class that intentionally contains multiple security defects — your job is to identify, categorise, and fix each one.

## Requirements

1. Open `VulnerableUserService.java` in `starter-code/`. Read each method and its `// VULNERABILITY` comment.
2. In `SecurityAnalysis.java` (also in `starter-code/`), complete the `analyzeVulnerabilities()` method by filling in the name of the **OWASP Top 10** category that best describes each flaw (use the constants provided).
3. In `SecureUserService.java` (starter-code), implement each method with the security flaw removed:
   - `getUserById(String id)` — fix the SQL injection by using a `PreparedStatement`.
   - `login(String username, String password)` — fix the plaintext password comparison by using `BCrypt.checkpw()`.
   - `getConfigValue(String key)` — fix the sensitive data exposure by never returning secrets directly to the caller; return a masked value instead.
   - `logUserAction(String userInput)` — fix the log injection by stripping newline characters before logging.
4. Run `SecurityAnalysisTest` and confirm all assertions pass.

## Hints

- OWASP A03:2021 is Injection; A07:2021 is Identification and Authentication Failures; A02:2021 is Cryptographic Failures; A09:2021 is Security Logging and Monitoring Failures.
- For SQL injection the fix is always a parameterised query — **never** string concatenation.
- BCrypt is a one-way hash; you never decrypt a password, you re-hash the input and compare.
- Log injection works by embedding `\n` or `\r` to forge new log lines — strip them before logging.

## Expected Output

```
=== OWASP Vulnerability Analysis ===
getUserById      → A03:2021 - Injection
login            → A07:2021 - Identification and Authentication Failures
getConfigValue   → A02:2021 - Cryptographic Failures
logUserAction    → A09:2021 - Security Logging and Monitoring Failures

=== Secure Implementations ===
getUserById(1)       → User{id=1, name='Alice'}
login(valid)         → true
login(invalid)       → false
getConfigValue(key)  → db.password = [REDACTED]
logUserAction(clean) → logged safely
```
